--  simple operations with track spatial object

select *
from a, (select * from (select rgsd.*, b.id from
(select SDO_GEOMETRY(
            2001, 8307,
            SDO_POINT_TYPE(
			floor(LON/100.0)+((LON-floor(LON/100.0)*100)/60.0), 
			floor(LAT/100.0)+((LAT-floor(LAT/100.0)*100)/60.0),
            NULL ),NULL,NULL    
       ) geom,  a.*
from RAW_GPS_STOPPOINT_DATA a) rgsd left outer join SEPARATION_STATIONS_geom b
on SDO_NN(b.geom, rgsd.geom, 'SDO_NUM_RES=1 DISTANCE=400',1)='TRUE')
where ID is null) sd
where -- SDO_NN(a.geom, sd.geom, 'SDO_NUM_RES=1 DISTANCE=400',1)='TRUE'
SDO_GEOM.SDO_DISTANCE(a.geom, sd.geom, 0.5, ' UNIT=METER ') < 10000
;


select * 
from (select * from (select rgsd.*, b.id from
(select SDO_GEOMETRY(
            2001, 8307,
            SDO_POINT_TYPE(
			floor(LON/100.0)+((LON-floor(LON/100.0)*100)/60.0), 
			floor(LAT/100.0)+((LAT-floor(LAT/100.0)*100)/60.0),
            NULL ),NULL,NULL    
       ) geom,  a.*
from raw_gps_station_data a) rgsd left outer join SEPARATION_STATIONS_geom b
on SDO_NN(b.geom, rgsd.geom, 'SDO_NUM_RES=1 DISTANCE=400',1)='TRUE')
where ID is null) sd join gas_railway.railkilometerage rk 
					on sd.KOORDINATA*1000 = rk.KILOMETERAGESTART
where sd.KOORDINATA != 0				
order by KOORDINATA desc	;


select * from (select rgsd.*, b.id from
(select SDO_GEOMETRY(
            2001, 8307,
            SDO_POINT_TYPE(
			floor(LON/100.0)+((LON-floor(LON/100.0)*100)/60.0), 
			floor(LAT/100.0)+((LAT-floor(LAT/100.0)*100)/60.0),
            NULL ),NULL,NULL    
       ) geom,  a.*
from raw_gps_station_data a) rgsd left outer join SEPARATION_STATIONS_geom b
on SDO_NN(b.geom, rgsd.geom, 'SDO_NUM_RES=1 DISTANCE=400',1)='TRUE')
where ID is null;


with a as (select mdsys.sdo_geometry(2002,8307,mdsys.sdo_point_type(null,null,null),
SDO_ELEM_INFO_ARRAY (1, 2, 1),SDO_ORDINATE_ARRAY(
37.56344,49.6526333,
37.5618683,49.6531366,
37.56027,49.6535566,
37.5586416,49.65388,
37.5570216,49.654165,
37.55544,49.6544466,
37.553915,49.6547566,
37.5524766,49.65514,
37.5511283,49.65556,
37.549835,49.6559716,
37.5485683,49.6563733,
37.5485683,49.6563733,
37.547295,49.656775,
37.54599,49.6571816,
37.5444283,49.6575366,
37.543035,49.65768,
37.541425,49.657655,
37.539795,49.6574433,
37.5381733,49.6571866,
37.53653,49.6571083,
37.5349316,49.65727,
37.5334183,49.657665,
37.531985,49.65825,
37.53046,49.6588533,
37.5286583,49.6592366,
37.52646,49.6593183,
37.5243616,49.6590933,
37.52219,49.6588166,
37.5199633,49.65851,
37.517765,49.6580183,
37.51557,49.65745,
37.5133233,49.6569266,
37.51093,49.6566816,
37.50849,49.6568166,
37.5061533,49.6573233,
37.504075,49.6581733,
37.5022733,49.6592316,
37.5005083,49.660295,
37.4987566,49.6613533,
37.4970216,49.6624,
37.495165,49.66333,
37.4930316,49.6639233,
37.490755,49.6641366,
37.4884866,49.6639666,
37.4863766,49.66343,
37.4845166,49.6626083,
37.4827016,49.6617583,
37.4807216,49.6611433,
37.4786583,49.660815,
37.476595,49.6607633,
37.4746016,49.6609666,
37.47274,49.6613033,
37.4709883,49.6616816,
37.4693783,49.6621566,
37.4678716,49.6626633,
37.466665,49.663205,
37.4655266,49.6638983,
37.464625,49.6646366,
37.4639033,49.6653733,
37.4632533,49.6660816,
37.4626066,49.6667783,
37.46191,49.667465,
37.461075,49.6680966,
37.4601066,49.6686533,
37.4590266,49.669125,
37.457895,49.6695583,
37.456755,49.66999,
37.455525,49.6704966,
37.454585,49.6709883,
37.453565,49.6717183,
37.4528516,49.6724166,
37.4521616,49.67326,
37.45147,49.6741266,
37.4507566,49.674995,
37.4497916,49.67587,
37.44885,49.676485,
37.4478066,49.677135,
37.4467433,49.6777433,
37.4456333,49.6783033,
37.4445066,49.6788666,
37.4433516,49.6794416,
37.4421533,49.68002,
37.44076,49.6806866,
37.4394366,49.681335,
37.438155,49.6821,
37.43686,49.6829133,
37.4355283,49.6837416,
37.4341033,49.6845233,
37.4325516,49.68522,
37.430875,49.6857983,
37.4290833,49.6862383,
37.4272316,49.6865816,
37.4253333,49.6868266,
37.423395,49.6869183,
37.4214416,49.686945,
37.4194716,49.6870183,
37.4174633,49.6871133,
37.4154,49.68721,
37.4132866,49.687375,
37.4112266,49.687805,
37.4092066,49.6883283,
37.40715,49.68876,
37.4051,49.6891666,
37.403115,49.68968,
37.401205,49.6903066,
37.3992983,49.6909366,
37.3973416,49.69149,
37.3955216,49.6918783,
37.3934766,49.6922216,
37.3913816,49.69227,
37.3893416,49.692005,
37.3874733,49.691435,
37.3859116,49.6905716,
37.38478,49.689465,
37.3841566,49.6882,
37.3840516,49.68687,
37.3840933,49.6855316,
37.3838616,49.684205,
37.3831583,49.68295,
37.3820316,49.681835,
37.3805616,49.6809133,
37.3789966,49.6800666,
37.3775183,49.679165,
37.3762133,49.6781566,
37.3749466,49.67712,
37.3736666,49.6760766,
37.3723766,49.6750233,
37.3710683,49.6739533,
37.36971,49.6728783,
37.3681433,49.6718983,
37.3663433,49.6710683,
37.3644466,49.6703083,
37.3625516,49.6695483,
37.3605416,49.6687483,
37.3585783,49.6679633)) geom from dual)

